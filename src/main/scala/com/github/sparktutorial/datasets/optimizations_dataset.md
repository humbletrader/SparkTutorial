Optimizations for spark when using datasets