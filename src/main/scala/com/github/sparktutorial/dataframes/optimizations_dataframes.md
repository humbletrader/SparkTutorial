Optimizations for spark when using dataframes